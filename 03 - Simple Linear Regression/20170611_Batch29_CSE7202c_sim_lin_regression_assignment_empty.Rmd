---
title: "Simple Linear Regression Assignment"
author: "INSOFE Lab Assignment"
date: "6 June 2017"
output:
  html_document:
    toc: yes
    toc_depth: 3
    toc_float: yes
---

**NOTE** Before starting this assignment please remember to clear your environment, you can do that by running the following code chunk

```{r}

rm(list = ls(all=TRUE))

```

# Combined Cycle Power Plant Data Set

The dataset given to you has been collected from a **Combined Cycle Power Plant** over 6 years (2006-2011).

A combined cycle power plant (CCPP) is composed of gas turbines (GT), steam turbines (ST) and heat recovery steam generators. In a CCPP, the electricity is generated by gas and steam turbines, which are combined in one cycle, and is transferred from one turbine to another. While the Vacuum is colected from and has effect on the Steam Turbine, the other three of the ambient variables effect the GT performance.

The variables in the dataset are as follows:

* __AmbTemp__ :  Hourly average of ambient Temperature at the plant (Range 1.81°C and 37.11°C)


* __Exvac__ : Exhaust Vacuum is pumps air out of the steam turbine (Range 25.36-81.56 cm Hg)


* __AmbPress__ : Hourly average of ambient Pressure at the plant (Range 992.89-1033.30 milibar)


* __RelHum__ : Hourly average of ambient relative humidity at the plant (Range 25.56% to 100.16%)


* __ElOut__ : Net hourly Electrical Energy Output of the plant (Range 420.26-495.76 MW)


# Agenda for the assignment

* Get the data

* Ask interesting questions

* Explore the data

* Clean and Process the Data

* Model the data

* Evaluation and Communication


# Read the Data

* Read in the data and store it in a variable

```{r}
setwd("C:/Users/welcome/Downloads/20170611-batch29-cse7202c-sim-lin-regression-kirankumarpatroinsofe-master/20170611-batch29-cse7202c-sim-lin-regression-kirankumarpatroinsofe-master")

CCPP_data <- read.csv("CCPP.csv")
View(CCPP_data)

```

# Understand the Data

* How many Observations are there in the dataset? What are the data types of the variables?

```{r}

summary(CCPP_data)


```


* Get some descriptive statistics of the variables in the dataset

```{r}
str(CCPP_data)

```

# Ask Some Questions

* How does the ambient temperature effect the electical energy output generation at the CCPP?

* ???

* ???


# Exploratory Analysis

* Plot the relationships between the explanatory and response variables

```{r}
par(mfrow = c(2,2))

plot(CCPP_data$AmbTemp, CCPP_data$Price, xlab = "AmbTemp", ylab = "ElOut", main = "AmbTemp vs ElOut")

plot(CCPP_data$ExVac, CCPP_data$Price, xlab = "ExVac", ylab = "ElOut", main = "ExVac vs ElOut")

plot(CCPP_data$AmbPress, CCPP_data$Price, xlab = "AmbPress", ylab = "ElOut", main = "AmbPress vs ElOut")

plot(CCPP_data$RelHum, CCPP_data$Price, xlab = "RelHum", ylab = "ElOut", main = "RelHum vs ElOut")


```

* Plot a Correlation Plot

```{r}

cor_matrix <- cor(CCPP_data[,c("AmbTemp", "ExVac", "AmbPress", "RelHum", "ElOut")], use = "complete.obs")
library(corrplot)
corrplot(cor_matrix, method = "number")

```

# Data Cleaning and Pre-Processing

* Are all the variables in the correct data type? 

* Do you need to convert the data type of any of the variables?

```{r}
CCPP_data[, "RelHum"] <- as.factor(CCPP_data[, "RelHum"])


```

* How many Missing Values does the dataset have? 

```{r}
sum(is.na(CCPP_data))

```

* Either remove or impute the missing values in the dataset

```{r}

CCPP_data <- na.omit(CCPP_data)


```

* Standardize (Scale and Center) the explanatory variables

```{r}
CCPP_numeric_data <- scale(CCPP_data[, !(names(CCPP_data) %in% c("AmbTemp", "ExVac", "AmbPress", "RelHum"))])

CCPP_data[, !(names(CCPP_data) %in% c("AmbTemp", "ExVac", "AmbPress", "RelHum"))] <- CCPP_numeric_data

str(CCPP_data)

```

* Split the data into train and test data sets (70/30)

```{r}
set.seed(007)

train_rows <- sample(x = 1:nrow(CCPP_data), size = 0.70*nrow(CCPP_data))

train_data <- CCPP_data[train_rows, ]
test_data <- CCPP_data[-train_rows, ]


```


# Build Models

* Build four simple linear regression models

* Note down the coefficients, intercepts, R^2 and p-values of the models you built. 

* Plot the residual plots

```{r}
model1 <- lm(formula = ElOut ~ AmbTemp, data = train_data)

summary(model1)

par(mfrow = c(2,2))

plot(model1)


```


```{r}
model2 <- lm(ElOut ~ ExVac,
            data = train_data)

summary(model2)

par(mfrow = c(2,2))

plot(model2)


```



```{r}
model3 <- lm(ElOut ~ AmbPress,
            data = train_data)

summary(model3)

par(mfrow = c(2,2))

plot(model3)

```



```{r}

model4 <- lm(ElOut ~ RelHum,
            data = train_data)

summary(model4)

par(mfrow = c(2,2))

plot(model4)

```


# Evaluate the Model

* Select a model by noting the R^2 values of the models you built

```{r}
model_names <- c("AmbTemp vs Price", "ExVac vs Price",
                 "AmbPress vs Price", "RelHum vs Price")

r2_values <- c(summary(model1)$r.squared, summary(model2)$r.squared,
               summary(model3)$r.squared, summary(model4)$r.squared)

r2 <- cbind(model_names, r2_values)

barplot(r2_values, names.arg = r2[,1], cex.names = 0.78, ylim = c(0, 0.8),
        main = "A Barplot of R^2 Values of Various Models", xlab = "Models",
        ylab = "Variance in Price Explained (R^2)")



```




# Report Performace Metrics

* Construct atleast two performance/evaluation metrics

```{r}
#Mean Absolute Error (MAE)

mae <- function(actual, predicted){
  
  error <- actual - predicted
  
  mean(abs(error))
  
}




```

```{r}
mse <- function(actual, predicted){
  
  error <- actual - predicted
  
  mean(error^2)
  
}




```

```{r}
rmse <- function(actual, predicted){
  
  error <- actual - predicted
  
  sqrt(mean(error^2))
  
}




```

* Predict Test data based on the chosen model

```{r}
preds_model <- predict(model1, test_data[, !(names(test_data) %in% c("ElOut"))])



```


* Report the performance and final regression formula of the chosen model
*Note:* the formula may change from individual to individual

```{r}
mae(test_data$ElOut, preds_model)

mse(test_data$ElOut, preds_model)

rmse(test_data$ElOut, preds_model)

library(DMwR)
library(lattice)

regr.eval(test_data$ElOut, preds_model)

summary(model1)

```





































